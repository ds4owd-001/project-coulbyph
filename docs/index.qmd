---
title: "My project"
author: "Phaniwa"
date: today
format: html
    toc: true
execute:
editor: visual
bibliography: references.bib
---

#Introduction

In Abidjan (Cote d'Ivoire), the situation of sanitation was exacerbated by the sociopolitical and military crisis of 2002-2011 (Ouattara et al. 2017). This study was carried out in two low-income parts of Abidjan in order to understand the behavior and practices of the population in terms of managing sanitation facilities, as well as to assess the diseases they face.

#Methods

The data were collected from household surveys in two low_income areas of Abidjan. Indeed, the surveys included 101 households in Abobo and 106 households from Yopougon. The survey was focusing on practices related to the management of sanitation facilities (latrines and tanks).

**Import**

```{r}
library(readxl)
```

```{r}
read_excel(here::here("data/raw/Survey_base.xlsx"))
```

```{r}
library(tidyverse)
```

Import data

```{r}
read_excel(here::here("data/raw/Survey_base.xlsx"))

data_raw <- read_excel(here::here ("data/raw/Survey_base.xlsx"))
```

**Rename column**

```{r}
data_clean<-data_raw|>
  rename(stay_time = living_time,
         lat_facilities = latrine_presence,
         facilities_type = latrine_type,
         lat_use = using_latrines,
         nb_user = users,
         facilities_loc = location,
         lat_care = latrine_cleaning,
         clean_freq_wk = cleaning_freqce_wk,
         tk_status = tank_operation,
         empty_freq_yr = emptying_frqce_yr,
         empty_mode = emptying_mode,
         empty_price = emptying_price,
         wastwat_dispos = household_wastewater,
         waste_cont = garbage_cont,
         waste_cont_loc = garbage_loc,
         cont_empy_wk = garbage_emptying_wk,
         common_ill = common_diseases
         ) 
  data_ready<- data_clean [,-c(1,4,6)]
  
```

**Harmonised data**

```{r}
data_clean <- data_ready|>
  mutate(nb_user_new=case_when(
    nb_user == "1_3"~"2",
    nb_user == "4_6"~"5",
    nb_user == "7_10"~"8.5",
    nb_user == ">10"~ "10"
  )) |>
  mutate(clean_freq = case_when(
    clean_freq_wk == "1_3" ~ "2",
    clean_freq_wk == ">4"~"4"
  )) |>
  mutate(lat_nb_new= case_when(
    latrines_nb == "1_5"~"3",
    latrines_nb == "6_10"~"8",
    latrines_nb == ">10"~"10"
  )) |>
  mutate(empty_price_new= case_when(
    empty_price == "10000_20000"~"15000",
    empty_price == "20000_40000"~"30000",
    empty_price == ">40000"~"40000"
  )) |>
  mutate(cont_empty_wk=case_when(
    cont_empy_wk == "1_3"~"2",
    cont_empy_wk == "4_7"~"5.5"
  )) |>
mutate(nb_user_new = as.numeric(nb_user_new))|>
mutate(clean_freq= as.numeric(clean_freq)) |>
mutate(lat_nb_new= as.numeric(lat_nb_new)) |>
mutate(empty_price_new = as.numeric(empty_price_new)) |>
mutate(cont_empty_wk = as.numeric(cont_empty_wk))
  

```

**Data per area**

```{r}
library(dplyr)
yop_data <- data_clean |>
  filter(area_name == 'Yopougon') 
  
Abobo_data <- data_clean |>
  filter(area_name == 'Abobo')

```

```         
```

#Results

```{r}
lat_use_per_area<-data_clean|>
  filter(!is.na(lat_nb_new))  |> 
   group_by(area_name)|>
summarise(
 count = n(),
 mean = mean(lat_nb_new),
 sd = sd(lat_nb_new),
 median = median(lat_nb_new),
 min = min(lat_nb_new),
 max = max(lat_nb_new)
 )
 
```

```{r}
library(gt)
library(knitr)
```

```{r}
lat_use_per_area |> 
    gt() |> 
    tab_header(title = "Latrines using by study areas",
               subtitle = "Data from 2 neighborhoods") |>
    fmt_number(columns = count:max, decimals = 0) |> 
    cols_label(area_name = "study areas")
```

@tbl-use-lat-areas highlights the fact that people in the different neighborhoods studied have identical latrine use habits.

```{r}
#| label: tbl-use-lat-areas
#| tbl-cap: "Latrines using by study areas. Data from 2 neighborhoods."
lat_use_per_area |> 
    rename(`study areas` = area_name)
```

```{r}
library(questionr)
 describe (yop_data$tk_status)
 describe (Abobo_data$tk_status)

```

```{r}
tank_statut_Abobo<-c("failure_presence", "no_failure","NA")
Number<-c(35, 56 ,10)
Frequency<-c(34.6, 55.4 , 9.9)

tb1 <-data.frame(tank_statut_Abobo,Number,Frequency)
  
```

```{r}
tank_statut_Yop<-c("failure_presence", "no_failure","NA")
Number<-c(44, 59 ,3)
Frequency<-c(41.5, 55.6 , 2.8)

tb2 <-data.frame(tank_statut_Yop,Number,Frequency)
```

```{r}
ggplot(data = tb1,
   mapping = aes(x= tank_statut_Abobo, 
                     y= Frequency,
                 fill = tank_statut_Abobo))+
  geom_col()


```

```{r}


ggplot(data = tb2,
   mapping = aes(x= tank_statut_Yop, 
                     y= Frequency,
                 fill = tank_statut_Yop))+
  geom_col()

```

The results show that a lot of tanks are dysfunctional in the study area. In Abobo 45% of septik tank doesn't work well, while in Yopougon it concerns 49% of septik tank .

```{r}
layout(matrix(1:2,1,2))
ggplot(data = tb1,
   mapping = aes(x= tank_statut_Abobo, 
                     y= Frequency,
                 fill = tank_statut_Abobo))+
  geom_col();
ggplot(data = tb2,
   mapping = aes(x= tank_statut_Yop, 
                     y= Frequency,
                 fill = tank_statut_Yop))+
  geom_col()
```

#Conclusions

#References

## Quarto

Quarto enables you to weave together content and executable code into a finished document. To learn more about Quarto see <https://quarto.org>.

## Running Code

When you click the **Render** button a document will be generated that includes both content and the output of embedded code. You can embed code like this:

```{r}
1 + 1
```

You can add options to executable code like this

```{r}
#| echo: false
2 * 2
```

The `echo: false` option disables the printing of code (only output is displayed).
